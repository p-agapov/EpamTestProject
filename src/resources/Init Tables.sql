DROP TABLE IF EXISTS orders;
DROP TABLE IF EXISTS tours;
DROP TABLE IF EXISTS customers;
DROP TABLE IF EXISTS users;

CREATE TABLE IF NOT EXISTS users
(
  user_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  login VARCHAR UNIQUE NOT NULL,
  password VARCHAR,
  role VARCHAR
);

CREATE TABLE IF NOT EXISTS customers
(
  customer_id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  name VARCHAR,
  surname VARCHAR,
  vip BOOLEAN,
  user_id INT UNIQUE REFERENCES users(user_id) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS tours
(
  tour_id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  name VARCHAR,
  price INT,
  hot BOOLEAN,
  discount INT
);

CREATE TABLE IF NOT EXISTS orders
(
  order_id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  customer_id INT REFERENCES customers(customer_id) ON DELETE CASCADE,
  tour_id INT REFERENCES tours(tour_id) ON DELETE CASCADE,
  paid BOOLEAN
);
